apiVersion: config.stackrox.io/v1alpha1
kind: SecurityPolicy
metadata:
  name: unauthorized-process-execution
  namespace: stackrox
spec:
  policyName: "[GitOps] Unauthorized Process Execution"
  description: "Runtime: detect suspicious shells or interpreters executed inside containers."
  severity: HIGH_SEVERITY
  disabled: false

  lifecycleStages:
    - RUNTIME
  eventSource: DEPLOYMENT

  categories:
    - Process Activity

  process:
    - name: "sh"
    - name: "bash"
    - name: "zsh"
    - name: "dash"
